---
const toggleTheme = () => {
  // Check the current theme
  const isDark = document.documentElement.classList.contains('dark')

  // Toggle the `dark` class on the root element
  document.documentElement.classList.toggle('dark', !isDark)

  // Save the preference in localStorage
  localStorage.setItem('theme', !isDark ? 'dark' : 'light')
}

// On load, apply the saved theme or system preference
if (typeof window !== 'undefined') {
  const savedTheme = localStorage.getItem('theme')
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches

  if (savedTheme) {
    document.documentElement.classList.toggle('dark', savedTheme === 'dark')
  } else {
    document.documentElement.classList.toggle('dark', prefersDark)
  }
}
---

<button onClick={toggleTheme} class="p-2 bg-gray-200 dark:bg-gray-800 rounded">
  Toggle Theme
</button>
